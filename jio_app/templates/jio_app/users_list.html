{% extends 'jio_app/base_admin.html' %}
{% load static %}

{% block title %}Usuarios - JIO{% endblock %}

{% block content %}
<div class="panel-container">
  <div class="panel-header">
    <h1 class="panel-title">Usuarios</h1>
  </div>

  <div class="form-card">
    <div class="form-actions" style="justify-content: flex-start; flex-wrap: wrap; gap: .75rem; margin-bottom: .75rem;">
      <a href="{% url 'jio_app:create_admin' %}" class="btn btn-primary"><i class="fas fa-user-shield"></i> Agregar administrador</a>
      <button type="button" id="btnShareAdmin" class="btn btn-secondary" title="Compartir admin"><i class="fas fa-share-from-square"></i></button>
      <a href="{% url 'jio_app:create_delivery' %}" class="btn btn-primary"><i class="fas fa-motorcycle"></i> Agregar repartidor</a>
      <button type="button" id="btnShareDelivery" class="btn btn-secondary" title="Compartir repartidor"><i class="fas fa-share-from-square"></i></button>
    </div>
    <form method="get" class="form-grid" style="grid-template-columns: 1fr auto;align-items: end;">
      <label>Buscar
        <input type="text" name="q" value="{{ query }}" placeholder="Nombre, usuario, email o tipo">
      </label>
      <button class="btn btn-secondary" type="submit">Filtrar</button>
    </form>
  </div>

  <div class="form-card" style="overflow:auto;">
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Usuario</th>
          <th>Nombre</th>
          <th>Email</th>
          <th>Tipo</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for u in usuarios %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.get_full_name }}</td>
          <td>{{ u.email }}</td>
          <td>{{ u.get_tipo_usuario_display }}</td>
          <td style="white-space:nowrap;">
            <button class="btn btn-secondary" data-edit-user="{{ u.id }}">Editar</button>
            <button class="btn btn-danger" data-delete-user="{{ u.id }}">Eliminar</button>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6">No hay usuarios que coincidan.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  
  {% block extra_scripts %}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="{% static 'js/validaciones.js' %}"></script>
  <script>src="{% static 'js/users_list.js' %}"</script>
  {% endblock %}
</div>
{% endblock %}

